/* -------------------------- */
/* --- morpho_ouverture.c --- */
/* -------------------------- */

/*
 * Copyright (c) 2020 - 2021, Lionel Lacassagne, All rights reserved
  
 
 */

#include <stdio.h>
#include <stdlib.h>
#include <stddef.h>
#include <string.h>

#include "nrtype.h"
#include "nrdef.h"
#include "nrutil.h"
//#include "sequence.h"

#include "swp.h"
#include "morpho.h"
#include "morpho_erosion.h"
#include "morpho_dilatation.h"

// -------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_basic(uint8 **X, int i, int j0, int j1, uint8 **Y)
// -------------------------------------------------------------------------------------
{
    /*
        Version basique de fusion
    */
    uint8 t00, t01, t02; // colonnes temporaire
    uint8 t10, t11, t12;
    uint8 t20, t21, t22; 

    int j;
    for(j=j0; j<=j1; j++)
    {
        /*
            Calcule des cases temporaire 
        */
        t00 = MIN9( X[i-2][j-2], X[i-2][j-1], X[i-2][j],
                    X[i-1][j-2], X[i-1][j-1], X[i-1][j],
                    X[i+0][j-2], X[i+0][j-1], X[i+0][j]
                    );
        t01 = MIN9( X[i-2][j-1], X[i-2][j], X[i-2][j+1],
                    X[i-1][j-1], X[i-1][j], X[i-1][j+1],
                    X[i+0][j-1], X[i+0][j], X[i+0][j+1]
                    );
        t02 = MIN9( X[i-2][j], X[i-2][j+1], X[i-2][j+2],
                    X[i-1][j], X[i-1][j+1], X[i-1][j+2],
                    X[i+0][j], X[i+0][j+1], X[i+0][j+2]
                    );
        // ----------------------------------
        t10 = MIN9( X[i-1][j-2], X[i-1][j-1], X[i-1][j],
                    X[i+0][j-2], X[i+0][j-1], X[i+0][j],
                    X[i+1][j-2], X[i+1][j-1], X[i+1][j]
                    );
        
        t11 = MIN9( X[i-1][j-1], X[i-1][j], X[i-1][j+1],
                    X[i+0][j-1], X[i+0][j], X[i+0][j+1],
                    X[i+1][j-1], X[i+1][j], X[i+1][j+1]
                    );
        
        t12 = MIN9( X[i-1][j], X[i-1][j+1], X[i-1][j+2],
                    X[i+0][j], X[i+0][j+1], X[i+0][j+2],
                    X[i+1][j], X[i+1][j+1], X[i+1][j+2]
                    );
        // ----------------------------------
        t20 = MIN9( X[i+0][j-2], X[i+0][j-1], X[i+0][j],
                    X[i+1][j-2], X[i+1][j-1], X[i+1][j],
                    X[i+2][j-2], X[i+2][j-1], X[i+2][j]
                    );
        t21 = MIN9( X[i+0][j-1], X[i+0][j], X[i+0][j+1],
                    X[i+1][j-1], X[i+1][j], X[i+1][j+1],
                    X[i+2][j-1], X[i+2][j], X[i+2][j+1]
                    );
        t22 = MIN9( X[i+0][j], X[i+0][j+1], X[i+0][j+2],
                    X[i+1][j], X[i+1][j+1], X[i+1][j+2],
                    X[i+2][j], X[i+2][j+1], X[i+2][j+2]
                    );
        // ----------------------------------
        // calcule de la case finale 
        Y[i][j] = MAX9( t00, t01, t02,
                     t10, t11, t12,
                     t20, t21, t22
                     );
    }
}
// -----------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// -----------------------------------------------------------------------------------
{
    /*
        Version reduction de colonne de fusion ouverture
    */
    // Var des 5 lignes 
    uint8 *a0 = X[i-2]; // colonnes X
    uint8 *a1 = X[i-1];
    uint8 *a2 = X[i+0];
    uint8 *a3 = X[i+1]; 
    uint8 *a4 = X[i+2];

    uint8 *y = Y[i];


    uint8 t00, t01, t02; // colonnes temporaire
    uint8 t10, t11, t12;
    uint8 t20, t21, t22; 

    uint8 c00, c01, c02, c03, c04;
    uint8 c10, c11, c12, c13, c14;
    uint8 c20, c21, c22, c23, c24;
    
    int j = j0;
    c00 = MIN3(a0[j-2], a1[j-2], a2[j-2]); c10 = MIN3(a1[j-2], a2[j-2], a3[j-2]); c20 = MIN3(a2[j-2], a3[j-2], a4[j-2]);
    c01 = MIN3(a0[j-1], a1[j-1], a2[j-1]); c11 = MIN3(a1[j-1], a2[j-1], a3[j-1]); c21 = MIN3(a2[j-1], a3[j-1], a4[j-1]);
    c02 = MIN3(a0[j+0], a1[j+0], a2[j+0]); c12 = MIN3(a1[j+0], a2[j+0], a3[j+0]); c22 = MIN3(a2[j+0], a3[j+0], a4[j+0]);
    c03 = MIN3(a0[j+1], a1[j+1], a2[j+1]); c13 = MIN3(a1[j+1], a2[j+1], a3[j+1]); c23 = MIN3(a2[j+1], a3[j+1], a4[j+1]);
    
    t00 = MIN3(c00, c01, c02); t01 = MIN3(c01, c02, c03);
    t10 = MIN3(c10, c11, c12); t11 = MIN3(c11, c12, c13);
    t20 = MIN3(c20, c21, c22); t21 = MIN3(c21, c22, c23);
    
    for(j=j0; j<=j1; j++)
    {
        /*
            Calcule des cases temporaire 
        */
        c04 = MIN3(a0[j+2], a1[j+2], a2[j+2]); c14 = MIN3(a1[j+2], a2[j+2], a3[j+2]); c24 = MIN3(a2[j+2], a3[j+2], a4[j+2]);
        
        t02 = MIN3(c02, c03, c04);
        // ----------------------------------
        t12 = MIN3(c12, c13, c14);
        // ----------------------------------
        t22 = MIN3(c22, c23, c24);
        // ----------------------------------
        // calcule de la case finale 
        Y[i][j] = MAX9( 
                        t00, t01, t02,
                        t10, t11, t12,
                        t20, t21, t22
                    );
        
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
    }
}
// ----------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_ilu5_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// ----------------------------------------------------------------------------------------
{
    /*
        Version avec deroulage de boucle interne de degre 5 et
        reduction de colonnes de fusion 
    */

    // debug
    setborder1(j0-2, j1+2);
    
    // var des 5 lignes 
    uint8 *a0 = X[i-2]; // colonnes X
    uint8 *a1 = X[i-1];
    uint8 *a2 = X[i+0];
    uint8 *a3 = X[i+1];
    uint8 *a4 = X[i+2];

    // cases de X 
    uint8 a00, a01, a02, a03, a04;
    uint8 a10, a11, a12, a13, a14;
    uint8 a20, a21, a22, a23, a24;
    uint8 a30, a31, a32, a33, a34;
    uint8 a40, a41, a42, a43, a44;

    uint8 *Yi = Y[i];
    uint8 y;

    uint8 t00, t01, t02; // colonnes temporaire
    uint8 t10, t11, t12;
    uint8 t20, t21, t22;

    // colonnes 
    uint8 c00, c01, c02, c03, c04; 
    uint8 c10, c11, c12, c13, c14; 
    uint8 c20, c21, c22, c23, c24;

    int j = j0;

    // load 
    a00 = load1(a0, j-2); a10 = load1(a1, j-2); a20 = load1(a2, j-2); a30 = load1(a3, j-2); a40 = load1(a4, j-2);
    a01 = load1(a0, j-1); a11 = load1(a1, j-1); a21 = load1(a2, j-1); a31 = load1(a3, j-1); a41 = load1(a4, j-1);
    a02 = load1(a0, j  ); a12 = load1(a1, j  ); a22 = load1(a2, j  ); a32 = load1(a3, j  ); a42 = load1(a4, j  );
    a03 = load1(a0, j+1); a13 = load1(a1, j+1); a23 = load1(a2, j+1); a33 = load1(a3, j+1); a43 = load1(a4, j+1);

    // calcule des colonnes 
    c00 = MIN3( a00, a10, a20);
    c01 = MIN3( a01, a11, a21);
    c02 = MIN3( a02, a12, a22);
    c03 = MIN3( a03, a13, a23);

    c10 = MIN3( a10, a20, a30);
    c11 = MIN3( a11, a21, a31);
    c12 = MIN3( a12, a22, a32);
    c13 = MIN3( a13, a23, a33);

    c20 = MIN3(a20, a30, a40);
    c21 = MIN3(a21, a31, a41);
    c22 = MIN3(a22, a32, a42);
    c23 = MIN3(a23, a33, a43);
    
    // temp
    t00 = MIN3( c00, c01, c02);        
    t01 = MIN3( c01, c02, c03);
    
    t10 = MIN3( c10, c11, c12);
    t11 = MIN3( c11, c12, c13);

    t20 = MIN3( c20, c21, c22);
    t21 = MIN3( c21, c22, c23);
    
    // determination de l'intervalle de j
    int r = ((j1-3)%5);
    for(j=j0; j<=((j1-3)-r); j+=5)
    {
        // ----------------------------------LOOP 1-----------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;


        // ----------------------------------LOOP 2-----------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+3); a14 = load1(a1, j+3); a24 = load1(a2, j+3); a34 = load1(a3, j+3); a44 = load1(a4, j+3);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+1, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ----------------------------------LOOP 3-----------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+4); a14 = load1(a1, j+4); a24 = load1(a2, j+4); a34 = load1(a3, j+4); a44 = load1(a4, j+4);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+2, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ----------------------------------LOOP 4-----------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+5); a14 = load1(a1, j+5); a24 = load1(a2, j+5); a34 = load1(a3, j+5); a44 = load1(a4, j+5);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+3, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;


        // ----------------------------------LOOP 5-----------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+6); a14 = load1(a1, j+6); a24 = load1(a2, j+6); a34 = load1(a3, j+6); a44 = load1(a4, j+6);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+4, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
    }

    // epilogue
    j = ((j1-3)-r);
    j++;
    a00 = load1(a0, j-2); a10 = load1(a1, j-2); a20 = load1(a2, j-2); a30 = load1(a3, j-2); a40 = load1(a4, j-2);
    a01 = load1(a0, j-1); a11 = load1(a1, j-1); a21 = load1(a2, j-1); a31 = load1(a3, j-1); a41 = load1(a4, j-1);
    a02 = load1(a0, j  ); a12 = load1(a1, j  ); a22 = load1(a2, j  ); a32 = load1(a3, j  ); a42 = load1(a4, j  );
    a03 = load1(a0, j+1); a13 = load1(a1, j+1); a23 = load1(a2, j+1); a33 = load1(a3, j+1); a43 = load1(a4, j+1);

    c00 = MIN3( a00, a10, a20);
    c01 = MIN3( a01, a11, a21);
    c02 = MIN3( a02, a12, a22);
    c03 = MIN3( a03, a13, a23);

    c10 = MIN3( a10, a20, a30);
    c11 = MIN3( a11, a21, a31);
    c12 = MIN3( a12, a22, a32);
    c13 = MIN3( a13, a23, a33);

    c20 = MIN3(a20, a30, a40);
    c21 = MIN3(a21, a31, a41);
    c22 = MIN3(a22, a32, a42);
    c23 = MIN3(a23, a33, a43);
    
    // temp
    t00 = MIN3( c00, c01, c02);        
    t01 = MIN3( c01, c02, c03);
    
    t10 = MIN3( c10, c11, c12);
    t11 = MIN3( c11, c12, c13);

    t20 = MIN3( c20, c21, c22);
    t21 = MIN3( c21, c22, c23);

    switch (r+3)
    {
        case 7:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 6:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 5:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;
        
        case 4:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 3:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 2:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 1:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        default:
            break;
    }
}
// ----------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_elu2_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// ----------------------------------------------------------------------------------------
{
    /*
        Version avec deroulage de boucle interne de degre 5,
        deroulage de boucle interne de degre 2 et reduction de colonnes de fusion 
    */
   
    // Debug
    setborder1(j0-2, j1+2);

    // Var des 6 lignes 
    uint8 *a0 = X[i-2]; // lignes X
    uint8 *a1 = X[i-1];
    uint8 *a2 = X[i+0];
    uint8 *a3 = X[i+1];
    uint8 *a4 = X[i+2];
    uint8 *a5 = X[i+3]; // elu 2 

    uint8 *Yi0 = Y[i  ];
    uint8 *Yi1 = Y[i+1]; // elu2
    uint8 y0, y1;

    int j = j0;

    // cases de X 
    uint8 a00, a01, a02, a03, a04;
    uint8 a10, a11, a12, a13, a14;
    uint8 a20, a21, a22, a23, a24;
    uint8 a30, a31, a32, a33, a34;
    uint8 a40, a41, a42, a43, a44;
    uint8 a50, a51, a52, a53, a54;

    // load 
    a00 = load1(a0, j-2); a10 = load1(a1, j-2); a20 = load1(a2, j-2); a30 = load1(a3, j-2); a40 = load1(a4, j-2); a50 = load1(a5, j-2);
    a01 = load1(a0, j-1); a11 = load1(a1, j-1); a21 = load1(a2, j-1); a31 = load1(a3, j-1); a41 = load1(a4, j-1); a51 = load1(a5, j-1);
    a02 = load1(a0, j  ); a12 = load1(a1, j  ); a22 = load1(a2, j  ); a32 = load1(a3, j  ); a42 = load1(a4, j  ); a52 = load1(a5, j  );
    a03 = load1(a0, j+1); a13 = load1(a1, j+1); a23 = load1(a2, j+1); a33 = load1(a3, j+1); a43 = load1(a4, j+1); a53 = load1(a5, j+1);

    // colonnes 
    uint8 c00, c01, c02, c03, c04; 
    uint8 c10, c11, c12, c13, c14; 
    uint8 c20, c21, c22, c23, c24;
    uint8 c30, c31, c32, c33, c34;

    // calcul
    c00 = MIN3( a00, a10, a20);
    c01 = MIN3( a01, a11, a21);
    c02 = MIN3( a02, a12, a22);
    c03 = MIN3( a03, a13, a23);

    c10 = MIN3( a10, a20, a30);
    c11 = MIN3( a11, a21, a31);
    c12 = MIN3( a12, a22, a32);
    c13 = MIN3( a13, a23, a33);

    c20 = MIN3(a20, a30, a40);
    c21 = MIN3(a21, a31, a41);
    c22 = MIN3(a22, a32, a42);
    c23 = MIN3(a23, a33, a43);

    c30 = MIN3(a30, a40, a50);
    c31 = MIN3(a31, a41, a51);
    c32 = MIN3(a32, a42, a52);
    c33 = MIN3(a33, a43, a53);
    
    uint8 t00, t01, t02; // colonnes temporaire
    uint8 t10, t11, t12;
    uint8 t20, t21, t22;
    uint8 t30, t31, t32; // elu2

    // temp
    t00 = MIN3( c00, c01, c02);        
    t01 = MIN3( c01, c02, c03);
    
    t10 = MIN3( c10, c11, c12);
    t11 = MIN3( c11, c12, c13);

    t20 = MIN3( c20, c21, c22);
    t21 = MIN3( c21, c22, c23);

    t30 = MIN3( c30, c31, c32);
    t31 = MIN3( c31, c32, c33);

    // determination de l'intervalle de j
    for(j=j0; j<=j1; j++)
    {
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
    }

}
// ---------------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_ilu5_elu2_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// ---------------------------------------------------------------------------------------------
{
    /*
        Version avec deroulage de boucle interne de degre 5,
        deroulage de boucle interne de degre 2 et reduction de colonnes de fusion 
    */

   // Debug 
    setborder1(j0-2, j1+2);

    // Var des 6 lignes 
    uint8 *a0 = X[i-2]; // lignes X
    uint8 *a1 = X[i-1];
    uint8 *a2 = X[i+0];
    uint8 *a3 = X[i+1];
    uint8 *a4 = X[i+2];
    uint8 *a5 = X[i+3]; // elu 2 

    uint8 *Yi0 = Y[i  ];
    uint8 *Yi1 = Y[i+1]; // elu2
    uint8 y0, y1;

    int j = j0;

    // cases de X 
    uint8 a00, a01, a02, a03, a04;
    uint8 a10, a11, a12, a13, a14;
    uint8 a20, a21, a22, a23, a24;
    uint8 a30, a31, a32, a33, a34;
    uint8 a40, a41, a42, a43, a44;
    uint8 a50, a51, a52, a53, a54;

    // load 
    a00 = load1(a0, j-2); a10 = load1(a1, j-2); a20 = load1(a2, j-2); a30 = load1(a3, j-2); a40 = load1(a4, j-2); a50 = load1(a5, j-2);
    a01 = load1(a0, j-1); a11 = load1(a1, j-1); a21 = load1(a2, j-1); a31 = load1(a3, j-1); a41 = load1(a4, j-1); a51 = load1(a5, j-1);
    a02 = load1(a0, j  ); a12 = load1(a1, j  ); a22 = load1(a2, j  ); a32 = load1(a3, j  ); a42 = load1(a4, j  ); a52 = load1(a5, j  );
    a03 = load1(a0, j+1); a13 = load1(a1, j+1); a23 = load1(a2, j+1); a33 = load1(a3, j+1); a43 = load1(a4, j+1); a53 = load1(a5, j+1);

    // colonnes 
    uint8 c00, c01, c02, c03, c04; 
    uint8 c10, c11, c12, c13, c14; 
    uint8 c20, c21, c22, c23, c24;
    uint8 c30, c31, c32, c33, c34;

    // calcul
    c00 = MIN3( a00, a10, a20);
    c01 = MIN3( a01, a11, a21);
    c02 = MIN3( a02, a12, a22);
    c03 = MIN3( a03, a13, a23);

    c10 = MIN3( a10, a20, a30);
    c11 = MIN3( a11, a21, a31);
    c12 = MIN3( a12, a22, a32);
    c13 = MIN3( a13, a23, a33);

    c20 = MIN3(a20, a30, a40);
    c21 = MIN3(a21, a31, a41);
    c22 = MIN3(a22, a32, a42);
    c23 = MIN3(a23, a33, a43);

    c30 = MIN3(a30, a40, a50);
    c31 = MIN3(a31, a41, a51);
    c32 = MIN3(a32, a42, a52);
    c33 = MIN3(a33, a43, a53);
    
    uint8 t00, t01, t02; // colonnes temporaire
    uint8 t10, t11, t12;
    uint8 t20, t21, t22;
    uint8 t30, t31, t32; // elu2

    // temp
    t00 = MIN3( c00, c01, c02);        
    t01 = MIN3( c01, c02, c03);
    
    t10 = MIN3( c10, c11, c12);
    t11 = MIN3( c11, c12, c13);

    t20 = MIN3( c20, c21, c22);
    t21 = MIN3( c21, c22, c23);

    t30 = MIN3( c30, c31, c32);
    t31 = MIN3( c31, c32, c33);

    // determination de l'intervalle de j
    int r = ((j1-3)%5);
    for(j=j0; j<=((j1-3)-r); j+=5)
    {
        // ----------------------------------LOOP 1------------------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;

        // ----------------------------------LOOP 2------------------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+3); a14 = load1(a1, j+3); a24 = load1(a2, j+3); a34 = load1(a3, j+3); a44 = load1(a4, j+3); a54 = load1(a5, j+3);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j+1, y0);
        store1(Yi1, j+1, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;

        // ----------------------------------LOOP 3------------------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+4); a14 = load1(a1, j+4); a24 = load1(a2, j+4); a34 = load1(a3, j+4); a44 = load1(a4, j+4); a54 = load1(a5, j+4);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j+2, y0);
        store1(Yi1, j+2, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;

        // ----------------------------------LOOP 4------------------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+5); a14 = load1(a1, j+5); a24 = load1(a2, j+5); a34 = load1(a3, j+5); a44 = load1(a4, j+5); a54 = load1(a5, j+5);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j+3, y0);
        store1(Yi1, j+3, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        // ----------------------------------LOOP 5------------------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+6); a14 = load1(a1, j+6); a24 = load1(a2, j+6); a34 = load1(a3, j+6); a44 = load1(a4, j+6); a54 = load1(a5, j+6);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j+4, y0);
        store1(Yi1, j+4, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
    }

    j = ((j1-3)-r);
    j++;
    // Load 
    a00 = load1(a0, j-2); a10 = load1(a1, j-2); a20 = load1(a2, j-2); a30 = load1(a3, j-2); a40 = load1(a4, j-2); a50 = load1(a5, j-2);
    a01 = load1(a0, j-1); a11 = load1(a1, j-1); a21 = load1(a2, j-1); a31 = load1(a3, j-1); a41 = load1(a4, j-1); a51 = load1(a5, j-1);
    a02 = load1(a0, j  ); a12 = load1(a1, j  ); a22 = load1(a2, j  ); a32 = load1(a3, j  ); a42 = load1(a4, j  ); a52 = load1(a5, j  );
    a03 = load1(a0, j+1); a13 = load1(a1, j+1); a23 = load1(a2, j+1); a33 = load1(a3, j+1); a43 = load1(a4, j+1); a53 = load1(a5, j+1);

    c00 = MIN3( a00, a10, a20);
    c01 = MIN3( a01, a11, a21);
    c02 = MIN3( a02, a12, a22);
    c03 = MIN3( a03, a13, a23);

    c10 = MIN3( a10, a20, a30);
    c11 = MIN3( a11, a21, a31);
    c12 = MIN3( a12, a22, a32);
    c13 = MIN3( a13, a23, a33);

    c20 = MIN3(a20, a30, a40);
    c21 = MIN3(a21, a31, a41);
    c22 = MIN3(a22, a32, a42);
    c23 = MIN3(a23, a33, a43);

    c30 = MIN3(a30, a40, a50);
    c31 = MIN3(a31, a41, a51);
    c32 = MIN3(a32, a42, a52);
    c33 = MIN3(a33, a43, a53);  

    // temp
    t00 = MIN3( c00, c01, c02);        
    t01 = MIN3( c01, c02, c03);
    
    t10 = MIN3( c10, c11, c12);
    t11 = MIN3( c11, c12, c13);

    t20 = MIN3( c20, c21, c22);
    t21 = MIN3( c21, c22, c23);

    t30 = MIN3( c30, c31, c32);
    t31 = MIN3( c31, c32, c33);

    switch (r+3)
    {
    case 7:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 6:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 5:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 4:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 3:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 2:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 1:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        c14 = MIN3( a14, a24, a34);
        c24 = MIN3( a24, a34, a44);
        c34 = MIN3( a34, a44, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        y0 = MAX9(  t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        y1 = MAX9(  t10, t11, t12,
                    t20, t21, t22,
                    t30, t31, t32
                );
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    default:
        break;
    }
}
// ----------------------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_ilu5_elu2_red_factor(uint8 **X, int i, int j0, int j1, uint8 **Y)
// ----------------------------------------------------------------------------------------------------
{
    /*
        Version avec deroulage de boucle interne de degre 5,
        deroulage de boucle externe de degre 2 avec reduction de colonnes 
        en version factorise de fusion  
    */

    // debug 
    setborder1(j0-2, j1+2);

    // Var des 6 lignes 
    uint8 *a0 = X[i-2]; // lignes X
    uint8 *a1 = X[i-1];
    uint8 *a2 = X[i+0];
    uint8 *a3 = X[i+1];
    uint8 *a4 = X[i+2];
    uint8 *a5 = X[i+3]; // elu 2 

    uint8 *Yi0 = Y[i  ];
    uint8 *Yi1 = Y[i+1]; // elu2
    uint8 y0, y1;

    uint8 f; // factorisation

    uint8 f0, f1, f2, f3;

    int j = j0;

    // Var des cases de X 
    uint8 a00, a01, a02, a03, a04;
    uint8 a10, a11, a12, a13, a14;
    uint8 a20, a21, a22, a23, a24;
    uint8 a30, a31, a32, a33, a34;
    uint8 a40, a41, a42, a43, a44;
    uint8 a50, a51, a52, a53, a54;

    // load 
    a00 = load1(a0, j-2); a10 = load1(a1, j-2); a20 = load1(a2, j-2); a30 = load1(a3, j-2); a40 = load1(a4, j-2); a50 = load1(a5, j-2);
    a01 = load1(a0, j-1); a11 = load1(a1, j-1); a21 = load1(a2, j-1); a31 = load1(a3, j-1); a41 = load1(a4, j-1); a51 = load1(a5, j-1);
    a02 = load1(a0, j  ); a12 = load1(a1, j  ); a22 = load1(a2, j  ); a32 = load1(a3, j  ); a42 = load1(a4, j  ); a52 = load1(a5, j  );
    a03 = load1(a0, j+1); a13 = load1(a1, j+1); a23 = load1(a2, j+1); a33 = load1(a3, j+1); a43 = load1(a4, j+1); a53 = load1(a5, j+1);


    uint8 c00, c01, c02, c03, c04; 
    uint8 c10, c11, c12, c13, c14; 
    uint8 c20, c21, c22, c23, c24;
    uint8 c30, c31, c32, c33, c34;

    f   = MIN(  a10, a20);
    c00 = MIN(  a00, f);
    c10 = MIN(  f, a30);

    f   = MIN(  a11, a21);
    c01 = MIN(  a01, f);
    c11 = MIN(  f, a31);

    f   = MIN(  a12, a22);
    c02 = MIN(  a02, f);
    c12 = MIN(  f, a32);
    
    f   = MIN(  a13, a23);
    c03 = MIN(  a03, f);
    c13 = MIN(  f, a33);

    f   = MIN(  a30, a40);
    c20 = MIN(  a20, f);
    c30 = MIN(  f, a50);

    f   = MIN(  a31, a41);
    c21 = MIN(  a21, f);
    c31 = MIN(  f, a51);

    f   = MIN(  a32, a42);
    c22 = MIN(  a22, f);
    c32 = MIN(  f, a52);

    f   = MIN(  a33, a43);
    c23 = MIN( a23, f);
    c33 = MIN( f, a53);
    
    uint8 t00, t01, t02; // colonnes temporaire
    uint8 t10, t11, t12;
    uint8 t20, t21, t22;
    uint8 t30, t31, t32; // elu2

    // temp
    f   = MIN(  c01, c02);
    t00 = MIN(  c00, f);        
    t01 = MIN(  f, c03);
    
    f   = MIN(  c11, c12);
    t10 = MIN(  c10, f);
    t11 = MIN(  f, c13);

    f   = MIN(  c21, c22);
    t20 = MIN(  c20, f);
    t21 = MIN(  f, c23);

    f   = MIN(  c31, c32);
    t30 = MIN(  c30, f);
    t31 = MIN(  f, c33);

    // determination de l'intervalle de j
    int r = ((j1-3)%5);
    for(j=j0; j<=((j1-3)-r); j+=5)
    {
        //-------------------------------------LOOP 1--------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;

        //-------------------------------------LOOP 2--------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+3); a14 = load1(a1, j+3); a24 = load1(a2, j+3); a34 = load1(a3, j+3); a44 = load1(a4, j+3); a54 = load1(a5, j+3);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j+1, y0);
        store1(Yi1, j+1, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;

        //-------------------------------------LOOP 3--------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+4); a14 = load1(a1, j+4); a24 = load1(a2, j+4); a34 = load1(a3, j+4); a44 = load1(a4, j+4); a54 = load1(a5, j+4);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j+2, y0);
        store1(Yi1, j+2, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;

        //-------------------------------------LOOP 4--------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+5); a14 = load1(a1, j+5); a24 = load1(a2, j+5); a34 = load1(a3, j+5); a44 = load1(a4, j+5); a54 = load1(a5, j+5);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j+3, y0);
        store1(Yi1, j+3, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;

        //-------------------------------------LOOP 5--------------------------------------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+6); a14 = load1(a1, j+6); a24 = load1(a2, j+6); a34 = load1(a3, j+6); a44 = load1(a4, j+6); a54 = load1(a5, j+6);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j+4, y0);
        store1(Yi1, j+4, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
    }

    j = ((j1-3)-r);
    j++;
    // load 
    a00 = load1(a0, j-2); a10 = load1(a1, j-2); a20 = load1(a2, j-2); a30 = load1(a3, j-2); a40 = load1(a4, j-2); a50 = load1(a5, j-2);
    a01 = load1(a0, j-1); a11 = load1(a1, j-1); a21 = load1(a2, j-1); a31 = load1(a3, j-1); a41 = load1(a4, j-1); a51 = load1(a5, j-1);
    a02 = load1(a0, j  ); a12 = load1(a1, j  ); a22 = load1(a2, j  ); a32 = load1(a3, j  ); a42 = load1(a4, j  ); a52 = load1(a5, j  );
    a03 = load1(a0, j+1); a13 = load1(a1, j+1); a23 = load1(a2, j+1); a33 = load1(a3, j+1); a43 = load1(a4, j+1); a53 = load1(a5, j+1);

    f   = MIN(  a10, a20);
    c00 = MIN(  a00, f);
    c10 = MIN(  f, a30);

    f   = MIN(  a11, a21);
    c01 = MIN(  a01, f);
    c11 = MIN(  f, a31);

    f   = MIN(  a12, a22);
    c02 = MIN(  a02, f);
    c12 = MIN(  f, a32);
    
    f   = MIN(  a13, a23);
    c03 = MIN(  a03, f);
    c13 = MIN(  f, a33);

    f   = MIN(  a30, a40);
    c20 = MIN(  a20, f);
    c30 = MIN(  f, a50);

    f   = MIN(  a31, a41);
    c21 = MIN(  a21, f);
    c31 = MIN(  f, a51);

    f   = MIN(  a32, a42);
    c22 = MIN(  a22, f);
    c32 = MIN(  f, a52);

    f   = MIN(  a33, a43);
    c23 = MIN( a23, f);
    c33 = MIN( f, a53);  

    // temp
    f   = MIN(  c01, c02);
    t00 = MIN(  c00, f);        
    t01 = MIN(  f, c03);
    
    f   = MIN(  c11, c12);
    t10 = MIN(  c10, f);
    t11 = MIN(  f, c13);

    f   = MIN(  c21, c22);
    t20 = MIN(  c20, f);
    t21 = MIN(  f, c23);

    f   = MIN(  c31, c32);
    t30 = MIN(  c30, f);
    t31 = MIN(  f, c33);

    switch (r+3)
    {
    case 7:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 6:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 5:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 4:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 3:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 2:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    case 1:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2); a54 = load1(a5, j+2);
        
        // ----------------------------------
        // calc
        // ----------------------------------
        f   = MIN(  a14, a24);
        c04 = MIN(  a04, f);
        c14 = MIN(  f, a34);

        f   = MIN(  a34, a44);
        c24 = MIN(  a24, f);
        c34 = MIN(  f, a54);

        t02 = MIN3( c02, c03, c04);
        t12 = MIN3( c12, c13, c14);
        t22 = MIN3( c22, c23, c24);
        t32 = MIN3( c32, c33, c34);


        // ----------------------------------
        f   = MAX6(   t10, t11, t12, t20, t21, t22);

        y0  = MAX4(  t00, t01, t02, f);
        y1  = MAX4(  f, t30, t31, t32);
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi0, j, y0);
        store1(Yi1, j, y1);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        c32 = c33;
        c33 = c34;

        t30 = t31;
        t31 = t32;
        j++;

    default:
        break;
    }
}
// -----------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_ilu15_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// -----------------------------------------------------------------------------------------
{
    /*
        Version avec deroulage de boucle interne de degre 15 et reduction de colonnes de fusion 
    */

    // Var des 5 lignes
    setborder1(j0-2, j1+2);

    uint8 *a0 = X[i-2]; // colonnes X
    uint8 *a1 = X[i-1];
    uint8 *a2 = X[i+0];
    uint8 *a3 = X[i+1];
    uint8 *a4 = X[i+2];

    uint8 a00, a01, a02, a03, a04;
    uint8 a10, a11, a12, a13, a14;
    uint8 a20, a21, a22, a23, a24;
    uint8 a30, a31, a32, a33, a34;
    uint8 a40, a41, a42, a43, a44;

    uint8 *Yi = Y[i];
    uint8 y;

    uint8 t00, t01, t02; // colonnes temporaire
    uint8 t10, t11, t12;
    uint8 t20, t21, t22;

    uint8 c00, c01, c02, c03, c04; 
    uint8 c10, c11, c12, c13, c14; 
    uint8 c20, c21, c22, c23, c24;

    int j = j0;

    // load 
    a00 = load1(a0, j-2); a10 = load1(a1, j-2); a20 = load1(a2, j-2); a30 = load1(a3, j-2); a40 = load1(a4, j-2);
    a01 = load1(a0, j-1); a11 = load1(a1, j-1); a21 = load1(a2, j-1); a31 = load1(a3, j-1); a41 = load1(a4, j-1);
    a02 = load1(a0, j  ); a12 = load1(a1, j  ); a22 = load1(a2, j  ); a32 = load1(a3, j  ); a42 = load1(a4, j  );
    a03 = load1(a0, j+1); a13 = load1(a1, j+1); a23 = load1(a2, j+1); a33 = load1(a3, j+1); a43 = load1(a4, j+1);

    c00 = MIN3( a00, a10, a20);
    c01 = MIN3( a01, a11, a21);
    c02 = MIN3( a02, a12, a22);
    c03 = MIN3( a03, a13, a23);

    c10 = MIN3( a10, a20, a30);
    c11 = MIN3( a11, a21, a31);
    c12 = MIN3( a12, a22, a32);
    c13 = MIN3( a13, a23, a33);

    c20 = MIN3(a20, a30, a40);
    c21 = MIN3(a21, a31, a41);
    c22 = MIN3(a22, a32, a42);
    c23 = MIN3(a23, a33, a43);
    
    // temp
    t00 = MIN3( c00, c01, c02);        
    t01 = MIN3( c01, c02, c03);
    
    t10 = MIN3( c10, c11, c12);
    t11 = MIN3( c11, c12, c13);

    t20 = MIN3( c20, c21, c22);
    t21 = MIN3( c21, c22, c23);

    // determination de l'intervalle de j
    int r = (j1-14)%15;
    for(j=j0; j<=(j1-14)-r; j += 15)
    {
        // ------------------ 1 -------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        // ------------------ 2 -------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+3); a14 = load1(a1, j+3); a24 = load1(a2, j+3); a34 = load1(a3, j+3); a44 = load1(a4, j+3);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+1, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 3 -------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+4); a14 = load1(a1, j+4); a24 = load1(a2, j+4); a34 = load1(a3, j+4); a44 = load1(a4, j+4);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+2, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 4 -------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+5); a14 = load1(a1, j+5); a24 = load1(a2, j+5); a34 = load1(a3, j+5); a44 = load1(a4, j+5);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+3, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 5 -------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+6); a14 = load1(a1, j+6); a24 = load1(a2, j+6); a34 = load1(a3, j+6); a44 = load1(a4, j+6);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+4, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 6 -------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+7); a14 = load1(a1, j+7); a24 = load1(a2, j+7); a34 = load1(a3, j+7); a44 = load1(a4, j+7);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+5, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 7 -------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+8); a14 = load1(a1, j+8); a24 = load1(a2, j+8); a34 = load1(a3, j+8); a44 = load1(a4, j+8);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+6, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 8 -------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+9); a14 = load1(a1, j+9); a24 = load1(a2, j+9); a34 = load1(a3, j+9); a44 = load1(a4, j+9);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+7, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 9 -------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+10); a14 = load1(a1, j+10); a24 = load1(a2, j+10); a34 = load1(a3, j+10); a44 = load1(a4, j+10);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+8, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 10-------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+11); a14 = load1(a1, j+11); a24 = load1(a2, j+11); a34 = load1(a3, j+11); a44 = load1(a4, j+11);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+9, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 11-------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+12); a14 = load1(a1, j+12); a24 = load1(a2, j+12); a34 = load1(a3, j+12); a44 = load1(a4, j+12);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+10, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 12-------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+13); a14 = load1(a1, j+13); a24 = load1(a2, j+13); a34 = load1(a3, j+13); a44 = load1(a4, j+13);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+11, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 13-------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+14); a14 = load1(a1, j+14); a24 = load1(a2, j+14); a34 = load1(a3, j+14); a44 = load1(a4, j+14);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+12, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 14-------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+15); a14 = load1(a1, j+15); a24 = load1(a2, j+15); a34 = load1(a3, j+15); a44 = load1(a4, j+15);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+13, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

        // ------------------ 15-------------
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+16); a14 = load1(a1, j+16); a24 = load1(a2, j+16); a34 = load1(a3, j+16); a44 = load1(a4, j+16);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j+14, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;

    }
    j = ((j1-14)-r);
    j++;

    // load 
    a00 = load1(a0, j-2); a10 = load1(a1, j-2); a20 = load1(a2, j-2); a30 = load1(a3, j-2); a40 = load1(a4, j-2);
    a01 = load1(a0, j-1); a11 = load1(a1, j-1); a21 = load1(a2, j-1); a31 = load1(a3, j-1); a41 = load1(a4, j-1);
    a02 = load1(a0, j  ); a12 = load1(a1, j  ); a22 = load1(a2, j  ); a32 = load1(a3, j  ); a42 = load1(a4, j  );
    a03 = load1(a0, j+1); a13 = load1(a1, j+1); a23 = load1(a2, j+1); a33 = load1(a3, j+1); a43 = load1(a4, j+1);

    c00 = MIN3( a00, a10, a20);
    c01 = MIN3( a01, a11, a21);
    c02 = MIN3( a02, a12, a22);
    c03 = MIN3( a03, a13, a23);

    c10 = MIN3( a10, a20, a30);
    c11 = MIN3( a11, a21, a31);
    c12 = MIN3( a12, a22, a32);
    c13 = MIN3( a13, a23, a33);

    c20 = MIN3(a20, a30, a40);
    c21 = MIN3(a21, a31, a41);
    c22 = MIN3(a22, a32, a42);
    c23 = MIN3(a23, a33, a43);
    
    // temp
    t00 = MIN3( c00, c01, c02);        
    t01 = MIN3( c01, c02, c03);
    
    t10 = MIN3( c10, c11, c12);
    t11 = MIN3( c11, c12, c13);

    t20 = MIN3( c20, c21, c22);
    t21 = MIN3( c21, c22, c23);

    switch (r+14)
    {
        case 28:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 27:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;
        
        case 26:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 25:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 24:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;
        
        case 23:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 22:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 21:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 20:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 19:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 18:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 17:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 16:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 15:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 14:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;
        
        case 13:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 12:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 11:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 10:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;
        
        case 9:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 8:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 7:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 6:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 5:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;
        
        case 4:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 3:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 2:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        
        // ----------------------------------
        // Rotation de colonne et des var intermediaire
        // ----------------------------------
        c02 = c03;
        c03 = c04;

        t00 = t01;
        t01 = t02;

        c12 = c13;
        c13 = c14;

        t10 = t11;
        t11 = t12;

        c22 = c23;
        c23 = c24;

        t20 = t21;
        t21 = t22;
        j++;

        case 1:
        // ----------------------------------
        // load
        // ----------------------------------
        a04 = load1(a0, j+2); a14 = load1(a1, j+2); a24 = load1(a2, j+2); a34 = load1(a3, j+2); a44 = load1(a4, j+2);
        // ----------------------------------
        // calc
        // ----------------------------------
        c04 = MIN3( a04, a14, a24);
        t02 = MIN3( c02, c03, c04);

        // ----------------------------------
        c14 = MIN3( a14, a24, a34);
        t12 = MIN3( c12, c13, c14);
        
        // ----------------------------------
        c24 = MIN3(a24, a34, a44);
        t22 = MIN3( c22, c23, c24);

        // ----------------------------------
        y = MAX9(   t00, t01, t02,
                    t10, t11, t12,
                    t20, t21, t22
                );
        
        // ----------------------------------
        // store
        // ----------------------------------
        store1(Yi, j, y);
        default:
        break;
    }
}
// ---------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_basic(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y, uint8 **Z)
// ---------------------------------------------------------------------------------------------
{
     erosion3_ui8matrix_basic(X, i0-1, i1+1, j0-1, j1+1, Y);
    dilatation3_ui8matrix_basic(Y, i0,   i1,   j0,   j1,   Z);
}
// -----------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_basic(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// -----------------------------------------------------------------------------------------
{
    int i;
    for(i = i0; i <=i1; i++)
    {
        line_ouverture3_ui8matrix_fusion_basic(X, i, j0, j1, Y);
    }
}
// ---------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// ---------------------------------------------------------------------------------------
{
    int i;
    for(i = i0; i <=i1; i++)
    {
        line_ouverture3_ui8matrix_fusion_red(X, i, j0, j1, Y);
    }
}
// --------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_ilu5_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// --------------------------------------------------------------------------------------------
{
    int i;
    for(i = i0; i <=i1; i++)
    {
        line_ouverture3_ui8matrix_fusion_ilu5_red(X, i, j0, j1, Y);
    }
}
// ---------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_ilu15_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// ---------------------------------------------------------------------------------------------
{
    int i;
    for(i = i0; i <=i1; i++)
    {
        line_ouverture3_ui8matrix_fusion_ilu15_red(X, i, j0, j1, Y);
    }
}
// --------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_elu2_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// --------------------------------------------------------------------------------------------
{
    int i;
    int r = ((i1-1)%2);
    for(i = i0; i <=((i1-1)-r); i+=2)
    {
        line_ouverture3_ui8matrix_fusion_elu2_red(X, i, j0, j1, Y);
    }
    i = ((i1-1)-r);
    switch (r+1)
    {
    case 2:
        i++;
        line_ouverture3_ui8matrix_fusion_red(X, i, j0, j1, Y);
    case 1:
        i++;
        line_ouverture3_ui8matrix_fusion_red(X, i, j0, j1, Y);
    default:
        break;
    }
}
// -------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_ilu5_elu2_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// -------------------------------------------------------------------------------------------------
{
    int i;
    int r = ((i1-1)%2);
    for(i = i0; i <=((i1-1)-r); i+=2)
    {
        line_ouverture3_ui8matrix_fusion_ilu5_elu2_red(X, i, j0, j1, Y);
    }
    i = ((i1-1)-r);
    switch (r+1)
    {
    case 2:
        i++;
        line_ouverture3_ui8matrix_fusion_ilu5_red(X, i, j0, j1, Y);
    case 1:
        i++;
        line_ouverture3_ui8matrix_fusion_ilu5_red(X, i, j0, j1, Y);
    default:
        break;
    }
}
// --------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_ilu5_elu2_red_factor(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// --------------------------------------------------------------------------------------------------------
{
    int i;
    int r = ((i1-1)%2);
    for(i = i0; i <=((i1-1)-r); i+=2)
    {
        line_ouverture3_ui8matrix_fusion_ilu5_elu2_red_factor(X, i, j0, j1, Y);
    }
    i = ((i1-1)-r);
    switch (r+1)
    {
    case 2:
        i++;
        line_ouverture3_ui8matrix_fusion_ilu5_red(X, i, j0, j1, Y);
    case 1:
        i++;
        line_ouverture3_ui8matrix_fusion_ilu5_red(X, i, j0, j1, Y);
    default:
        break;
    }
}
// ------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_basic(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ------------------------------------------------------------------------------------------------------
{
    int i;
    int b = 1;
    i =i0-b;
    line_erosion3_ui8matrix_basic(X, i  , j0-b, j1+b, T);
    line_erosion3_ui8matrix_basic(X, i+1, j0-b, j1+b, T);
    for(i=i0; i<=i1; i++)
    {
        line_erosion3_ui8matrix_basic(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_basic(T, i  , j0-b+1, j1+b-1, Y);
    }
}
// ----------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ----------------------------------------------------------------------------------------------------
{
    int i;
    int b = 1;
    i =i0-b;
    line_erosion3_ui8matrix_red(X, i  , j0-b, j1+b, T);
    line_erosion3_ui8matrix_red(X, i+1, j0-b, j1+b, T);
    for(i=i0; i<=i1; i++)
    {
        line_erosion3_ui8matrix_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_red(T, i  , j0-b+1, j1+b-1, Y);
    }
}
// ---------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_ilu3_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ---------------------------------------------------------------------------------------------------------
{
    int i;
    int b = 1;
    i =i0-b;
    line_erosion3_ui8matrix_ilu3_red(X, i  , j0-b, j1+b, T);
    line_erosion3_ui8matrix_ilu3_red(X, i+1, j0-b, j1+b, T);
    for(i=i0; i<=i1; i++)
    {
        line_erosion3_ui8matrix_ilu3_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_ilu3_red(T, i  , j0-b+1, j1+b-1, Y);
    }
}
// ---------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_elu2_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ---------------------------------------------------------------------------------------------------------
{
    int i;
    int b = 1;
    i =i0-b;
    line_erosion3_ui8matrix_red(X, i  , j0-b, j1+b, T);
    line_erosion3_ui8matrix_red(X, i+1, j0-b, j1+b, T);
    
    int r = ((i1-1)%2);
    for(i=i0; i<=((i1-1)-r); i+=2)
    {
        line_erosion3_ui8matrix_elu2_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_elu2_red(T, i  , j0-b+1, j1+b-1, Y);
    }

    i = ((i1-1)-r);
    switch(r+1)
    {
    case 2:
        i++;
        line_erosion3_ui8matrix_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_red(T, i  , j0-b+1, j1+b-1, Y);
    case 1:
        i++; 
        line_erosion3_ui8matrix_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_red(T, i  , j0-b+1, j1+b-1, Y);
    default:
        break;
    }
}
// ----------------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_elu2_red_factor(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ----------------------------------------------------------------------------------------------------------------
{
    int i;
    int b = 1;
    i =i0-b;
    line_erosion3_ui8matrix_red(X, i  , j0-b, j1+b, T);
    line_erosion3_ui8matrix_red(X, i+1, j0-b, j1+b, T);
    
    int r = ((i1-1)%2);

    for(i=i0; i<=((i1-1)-r); i+=2)
    {
        line_erosion3_ui8matrix_elu2_red_factor(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_elu2_red_factor(T, i  , j0-b+1, j1+b-1, Y);
    }

    i = ((i1-1)-r);
    switch(r+1)
    {
    case 2:
        i++;
        line_erosion3_ui8matrix_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_red(T, i  , j0-b+1, j1+b-1, Y);
    case 1:
        i++; 
        line_erosion3_ui8matrix_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_red(T, i  , j0-b+1, j1+b-1, Y);
    default:
        break;
    }
}
// --------------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_ilu3_elu2_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// --------------------------------------------------------------------------------------------------------------
{
    int i;
    int b = 1;
    i =i0-b;
    line_erosion3_ui8matrix_ilu3_red(X, i  , j0-b, j1+b, T);
    line_erosion3_ui8matrix_ilu3_red(X, i+1, j0-b, j1+b, T);
    
    int r = ((i1-1)%2);

    for(i=i0; i<=((i1-1)-r); i+=2)
    {
        line_erosion3_ui8matrix_ilu3_elu2_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_ilu3_elu2_red(T, i  , j0-b+1, j1+b-1, Y);
    }

    i = ((i1-1)-r);
    switch(r+1)
    {
    case 2:
        i++;
        line_erosion3_ui8matrix_ilu3_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_ilu3_red(T, i  , j0-b+1, j1+b-1, Y);
    case 1:
        i++; 
        line_erosion3_ui8matrix_ilu3_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_ilu3_red(T, i  , j0-b+1, j1+b-1, Y);
    default:
        break;
    }
}
// ---------------------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_ilu3_elu2_red_factor(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ---------------------------------------------------------------------------------------------------------------------
{
    int i;
    int b = 1;
    i =i0-b;
    line_erosion3_ui8matrix_ilu3_red(X, i  , j0-b, j1+b, T);
    line_erosion3_ui8matrix_ilu3_red(X, i+1, j0-b, j1+b, T);
    
    int r = ((i1-1)%2);

    for(i=i0; i<=((i1-1)-r); i+=2)
    {
        line_erosion3_ui8matrix_ilu3_elu2_red_factor(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_ilu3_elu2_red_factor(T, i  , j0-b+1, j1+b-1, Y);
    }

    i = ((i1-1)-r);
    switch(r+1)
    {
    case 2:
        i++;
        line_erosion3_ui8matrix_ilu3_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_ilu3_red(T, i  , j0-b+1, j1+b-1, Y);
    case 1:
        i++; 
        line_erosion3_ui8matrix_ilu3_red(X, i+1, j0-b  , j1+b  , T);
        line_dilatation3_ui8matrix_ilu3_red(T, i  , j0-b+1, j1+b-1, Y);
    default:
        break;
    }
}
